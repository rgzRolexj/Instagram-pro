<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Clone</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter and a cursive font for the logo -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Satisfy&display=swap" rel="stylesheet">
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .logo-font {
            font-family: 'Satisfy', cursive;
        }
        /* Custom scrollbar for horizontal sections */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Ensure each page takes full height */
        .page {
            display: none; /* Hidden by default */
            height: 100vh;
            flex-direction: column;
        }
        .page.active {
            display: flex; /* Shown when active */
        }
        /* Profile grid tab styling */
        .profile-tab.active {
            border-bottom: 2px solid white;
        }
        .profile-tab svg {
            color: #8e8e8e; /* Gray for inactive */
        }
        .profile-tab.active svg {
            color: white; /* White for active */
        }
        /* Story progress bar animation */
        @keyframes progressAnimation {
            from { width: 0%; }
            to { width: 100%; }
        }
        .progress-bar-inner {
            animation: progressAnimation 5s linear forwards;
        }
    </style>
</head>
<body class="bg-gray-200">

    <!-- Main Container - constrained to a mobile viewport width -->
    <div class="max-w-md mx-auto h-screen flex flex-col relative shadow-xl bg-white">

        <!-- All pages are defined here -->

        <!-- Page 2: Instagram Feed -->
        <div id="feed-page" class="page active bg-black text-white">
            <!-- Feed Header -->
            <header class="p-4 flex items-center justify-between border-b border-gray-800 sticky top-0 bg-black z-10">
                <h1 class="logo-font text-3xl">Instagram</h1>
                <div class="flex items-center space-x-5">
                    <!-- Likes Icon -->
                    <svg onclick="showPage('notifications-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 016.364 0L12 7.636l1.318-1.318a4.5 4.5 0 116.364 6.364L12 20.364l-7.682-7.682a4.5 4.5 0 010-6.364z" />
                    </svg>
                    <!-- Messages Icon with Notification -->
                    <div class="relative cursor-pointer" onclick="showPage('dms-page')">
                        <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        <span class="absolute -top-1 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">25+</span>
                    </div>
                </div>
            </header>

            <!-- Main Content (Feed) -->
            <main id="feed-main-content" class="flex-1 overflow-y-auto">
                <!-- Stories Section -->
                <div class="p-3 border-b border-gray-800">
                    <div id="stories-container" class="flex space-x-4 overflow-x-auto no-scrollbar">
                        <!-- Stories will be injected here by JS -->
                    </div>
                </div>
                
                <!-- Posts Container -->
                <div id="posts-container">
                    <!-- Posts will be injected here by JS -->
                </div>

            </main>
            
            <!-- Footer Navigation -->
            <footer class="p-3 flex items-center justify-around border-t border-gray-800 sticky bottom-0 bg-black z-10">
                <!-- Home Icon (Filled) -->
                <svg id="footer-home-icon" onclick="showPage('feed-page')" class="h-7 w-7 cursor-pointer" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"></path>
                </svg>
                <!-- Search Icon (Outline) -->
                <svg id="footer-search-icon" onclick="showPage('search-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <!-- Add Post Icon (Outline) -->
                <svg onclick="showPage('new-post-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-3-3v6m6 6H6a3 3 0 01-3-3V6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3z" />
                </svg>
                <!-- Reels Icon -->
                <svg id="footer-reels-icon" onclick="showPage('reels-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                     <path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                     <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <!-- Profile Icon -->
                <div class="relative">
                    <img id="profile-icon-footer" onclick="showPage('profile-page')" class="w-7 h-7 rounded-full object-cover cursor-pointer" src="" alt="Profile">
                </div>
            </footer>
        </div>

        <!-- Page 3: Direct Messages -->
        <div id="dms-page" class="page bg-black text-white">
            <!-- DM Header -->
            <header class="p-4 flex items-center justify-between sticky top-0 bg-black z-10">
                <div class="flex items-center space-x-4">
                    <svg onclick="showPage('feed-page')" class="h-6 w-6 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                    <div class="flex items-center space-x-1">
                        <h1 id="dm-username" class="text-xl font-bold"></h1>
                        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 12h9.75M10.5 18h9.75M3.75 6.75h1.5M3.75 12h1.5m-1.5 5.25h1.5M5.25 6.75v-1.5m0 1.5v1.5m0 3.75v-1.5m0 1.5v1.5m-1.5-5.25v1.5m-1.5-1.5v1.5m0 3.75v-1.5m0 1.5v1.5"></path></svg>
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                </div>
            </header>
            
            <main class="flex-1 overflow-y-auto">
                <div class="px-4 py-2"><div class="bg-gray-800 rounded-lg flex items-center px-3 py-2"><svg class="h-5 w-5 text-gray-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" placeholder="Ask Meta AI or Search" class="bg-transparent w-full text-white placeholder-gray-400 focus:outline-none"></div></div>
                <div class="p-3"><div id="notes-container" class="flex space-x-4 overflow-x-auto no-scrollbar"></div></div>
                <div id="messages-container" class="px-4"></div>
            </main>
        </div>

        <!-- Page 4: Chat Detail -->
        <div id="chat-page" class="page bg-black text-white">
            <header id="chat-header" class="p-3 flex items-center justify-between border-b border-gray-800 sticky top-0 bg-black z-10"></header>
            <main class="flex-1 overflow-y-auto p-4 flex flex-col space-y-4">
                <div class="text-center text-xs text-gray-500 my-4">11:30 AM</div>
                <div class="flex items-end"><img id="chat-page-avatar-receiver" class="w-6 h-6 rounded-full object-cover mr-2" src="" alt=""><div class="bg-gray-800 rounded-2xl p-3 max-w-xs"><p>Hey! How are you?</p></div></div>
                <div class="flex items-end justify-end"><div class="bg-blue-500 rounded-2xl p-3 max-w-xs"><p>I'm good, thanks! How about you?</p></div></div>
                <div class="flex items-end"><img class="w-6 h-6 rounded-full object-cover mr-2" id="chat-page-avatar-receiver-2" src="" alt=""><div class="bg-gray-800 rounded-2xl p-3 max-w-xs"><p>Doing great! Just wanted to share this photo from my trip.</p></div></div>
                <div class="flex items-end"><img class="w-6 h-6 rounded-full object-cover mr-2" id="chat-page-avatar-receiver-3" src="" alt=""><img class="rounded-2xl max-w-[60%]" src="https://picsum.photos/seed/trip/400/500" alt="Trip Photo"></div>
            </main>
            <footer class="p-3 flex items-center space-x-3 border-t border-gray-800 sticky bottom-0 bg-black z-10"><div class="flex-1 bg-gray-800 rounded-full flex items-center px-2"><svg class="h-8 w-8 text-blue-400 bg-blue-500/20 rounded-full p-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg><input type="text" placeholder="Message..." class="bg-transparent w-full p-2 text-white placeholder-gray-400 focus:outline-none"></div><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14z" /></svg><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></footer>
        </div>

        <!-- Page 5: Profile Page -->
        <div id="profile-page" class="page bg-black text-white">
            <!-- Profile Header -->
            <header class="p-4 flex items-center justify-between sticky top-0 bg-black z-10">
                <div class="flex items-center space-x-4">
                    <svg onclick="showPage('feed-page')" class="h-6 w-6 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                    <div class="flex items-center space-x-2">
                        <h1 id="profile-username-header" class="text-xl font-bold"></h1>
                        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                     <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" /></svg>
                </div>
            </header>

            <!-- Profile Details -->
            <main class="flex-1 overflow-y-auto p-4">
                <div class="flex items-center space-x-4">
                    <div>
                        <img id="profile-picture-main" class="w-24 h-24 rounded-full object-cover" src="" alt="Profile Picture">
                    </div>
                    <div class="flex-1 flex justify-around text-center">
                        <div>
                            <p class="font-bold text-lg">15</p>
                            <p class="text-sm">Posts</p>
                        </div>
                        <div onclick="showPage('followers-page')" class="cursor-pointer">
                            <p class="font-bold text-lg">1.2M</p>
                            <p class="text-sm">Followers</p>
                        </div>
                        <div onclick="showPage('following-page')" class="cursor-pointer">
                            <p class="font-bold text-lg">210</p>
                            <p class="text-sm">Following</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 text-sm">
                    <h2 id="profile-fullname" class="font-semibold"></h2>
                    <p id="profile-bio-category">Reel Creator</p>
                    <p id="profile-bio-text">Muskuraiye, aap Lucknow mein hain 😊</p>
                    <a id="profile-bio-link" href="#" class="text-cyan-400">youtube.com/lucknowinawab</a>
                </div>

                <div class="mt-4 p-3 bg-gray-900 rounded-lg">
                    <h3 class="font-semibold">Professional dashboard</h3>
                    <p class="text-xs text-gray-400">3.2K profile visits in the last 7 days.</p>
                </div>

                <div class="flex items-center space-x-2 mt-4">
                    <button onclick="showPage('edit-profile-page')" class="flex-1 bg-gray-800 hover:bg-gray-700 text-sm font-semibold py-1.5 rounded-md">Edit profile</button>
                    <button class="flex-1 bg-gray-800 hover:bg-gray-700 text-sm font-semibold py-1.5 rounded-md">Share profile</button>
                    <button class="flex-1 bg-gray-800 hover:bg-gray-700 text-sm font-semibold py-1.5 rounded-md">Contact</button>
                </div>

                <div class="flex space-x-4 mt-4 overflow-x-auto no-scrollbar">
                    <div class="text-center flex-shrink-0">
                        <div class="w-16 h-16 rounded-full bg-gray-800 flex items-center justify-center">
                             <img src="https://i.postimg.cc/sXqC3yJc/whats-new.jpg" class="w-full h-full rounded-full object-cover" alt="Lucknow">
                        </div>
                        <p class="text-xs mt-1">Lucknow</p>
                    </div>
                    <div class="text-center flex-shrink-0">
                        <div class="w-16 h-16 rounded-full bg-gray-800 flex items-center justify-center">
                            <svg class="w-8 h-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                        </div>
                         <p class="text-xs mt-1">New</p>
                    </div>
                </div>

                <!-- Profile Tabs -->
                <div class="flex justify-around mt-6 border-b border-gray-800">
                    <button class="profile-tab active flex-1 py-2" onclick="switchProfileTab(this)">
                        <svg class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                    </button>
                    <button class="profile-tab flex-1 py-2" onclick="switchProfileTab(this)">
                       <svg class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                           <path stroke-linecap="round" stroke-linejoin="round" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                       </svg>
                    </button>
                    <button class="profile-tab flex-1 py-2" onclick="switchProfileTab(this)">
                        <svg class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                           <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </button>
                </div>


                <!-- Posts Grid -->
                <div class="grid grid-cols-3 gap-1 mt-1">
                    <img src="https://picsum.photos/seed/newpost1/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                    <img src="https://picsum.photos/seed/newpost2/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                    <img src="https://picsum.photos/seed/newpost3/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                    <img src="https://picsum.photos/seed/newpost4/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                    <img src="https://picsum.photos/seed/newpost5/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                    <img src="https://picsum.photos/seed/newpost6/300/300" alt="post" class="w-full h-full object-cover aspect-square">
                </div>
            </main>
        </div>

        <!-- Page 6: Edit Profile Page -->
        <div id="edit-profile-page" class="page bg-black text-white">
            <header class="p-4 flex items-center justify-between sticky top-0 bg-black z-10 border-b border-gray-800">
                <button onclick="showPage('profile-page')" class="text-lg">Cancel</button>
                <h1 class="text-lg font-bold">Edit profile</h1>
                <button id="done-editing-button" class="text-lg text-blue-500 font-bold">Done</button>
            </header>
            <main class="flex-1 overflow-y-auto p-4 text-center">
                <div class="relative inline-block">
                    <img id="edit-profile-picture" class="w-24 h-24 rounded-full object-cover" src="" alt="Profile Picture">
                </div>
                <label for="profile-pic-input-edit" class="block text-blue-500 mt-2 cursor-pointer">
                    Change profile photo
                </label>
                <input type="file" id="profile-pic-input-edit" accept="image/*" class="hidden">

                <div class="text-left mt-6">
                    <div class="border-b border-gray-800 py-2">
                        <label for="edit-name-input" class="text-gray-400">Name</label>
                        <input type="text" id="edit-name-input" class="w-full bg-transparent text-white focus:outline-none">
                    </div>
                     <div class="border-b border-gray-800 py-2">
                        <label for="edit-username-input" class="text-gray-400">Username</label>
                        <input type="text" id="edit-username-input" class="w-full bg-transparent text-white focus:outline-none">
                    </div>
                    <div class="border-b border-gray-800 py-2">
                        <label for="edit-bio-input" class="text-gray-400">Bio</label>
                        <textarea id="edit-bio-input" rows="3" class="w-full bg-transparent text-white focus:outline-none resize-none"></textarea>
                    </div>
                     <div class="py-2">
                        <p class="text-gray-400">Links</p>
                        <p id="edit-links-display" class="text-white">youtube.com/lucknowinawab</p>
                    </div>
                </div>
            </main>
        </div>
        
        <!-- Page 7: Story Viewer -->
        <div id="story-page" class="page bg-black text-white justify-between">
            <header class="p-3 flex items-center space-x-3 z-10">
                <div id="story-progress-bar" class="absolute top-1 left-2 right-2 h-0.5 bg-white/30 rounded-full"><div class="progress-bar-inner h-full bg-white rounded-full"></div></div>
                <img id="story-user-avatar" class="w-8 h-8 rounded-full object-cover" src="" alt="User Avatar">
                <span id="story-username" class="font-semibold text-sm"></span>
                <button onclick="showPage('feed-page')" class="ml-auto text-2xl font-bold">&times;</button>
            </header>
            <img id="story-image" src="" class="absolute inset-0 w-full h-full object-cover z-0" alt="Story">
            <footer id="story-footer" class="p-4 z-10 text-center hidden">
                 <svg class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
                <p class="text-sm font-semibold">1M views</p>
            </footer>
        </div>

        <!-- Page 8: Search Page -->
        <div id="search-page" class="page bg-black text-white">
            <main class="flex-1 overflow-y-auto">
                 <div class="p-4 sticky top-0 bg-black z-10">
                    <div class="bg-gray-800 rounded-lg flex items-center px-3">
                        <svg class="h-5 w-5 text-gray-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        <input type="search" placeholder="Search" class="bg-transparent w-full p-2 text-white placeholder-gray-400 focus:outline-none">
                    </div>
                </div>
                <div id="explore-grid" class="grid grid-cols-3 gap-1">
                    <!-- Explore content will be injected here by JS -->
                </div>
            </main>
            <footer class="p-3 flex items-center justify-around border-t border-gray-800 sticky bottom-0 bg-black z-10">
                <svg onclick="showPage('feed-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                <svg onclick="showPage('search-page')" class="h-7 w-7 cursor-pointer" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                <svg onclick="showPage('new-post-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-3-3v6m6 6H6a3 3 0 01-3-3V6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3z" /></svg>
                <svg onclick="showPage('reels-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <img id="profile-icon-footer-search" onclick="showPage('profile-page')" class="w-7 h-7 rounded-full object-cover cursor-pointer" src="" alt="Profile">
            </footer>
        </div>

        <!-- Page 9: New Post Page -->
        <div id="new-post-page" class="page bg-black text-white">
            <header class="p-4 flex items-center justify-between sticky top-0 bg-black z-10 border-b border-gray-800">
                <button onclick="showPage('feed-page')" class="text-lg">Cancel</button>
                <h1 class="text-lg font-bold">New post</h1>
                <button id="share-post-button" class="text-lg text-blue-500 font-bold">Share</button>
            </header>
            <main class="flex-1 overflow-y-auto p-4">
                <div id="post-preview-container" class="text-center bg-gray-900 rounded-lg p-4 flex flex-col items-center justify-center h-64">
                    <p class="text-gray-400">Select a photo to post</p>
                    <button id="select-photo-button" class="mt-4 bg-blue-500 text-white font-bold py-2 px-4 rounded">Select from computer</button>
                    <img id="post-image-preview" src="#" class="hidden max-h-full rounded-lg" alt="Post preview">
                </div>
                <div class="mt-4">
                    <textarea id="caption-input" class="w-full bg-transparent text-white placeholder-gray-400 focus:outline-none border-b border-gray-800 p-2" rows="3" placeholder="Write a caption..."></textarea>
                </div>
            </main>
        </div>
        
        <!-- Page 10: Reels Page -->
        <div id="reels-page" class="page bg-black text-white">
            <div id="reels-container" class="relative flex-1 h-full w-full">
                <!-- Video will be injected here -->
            </div>
             <footer class="p-3 flex items-center justify-around border-t border-gray-800 sticky bottom-0 bg-black z-10">
                <svg onclick="showPage('feed-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                <svg onclick="showPage('search-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                <svg onclick="showPage('new-post-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-3-3v6m6 6H6a3 3 0 01-3-3V6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3z" /></svg>
                <svg onclick="showPage('reels-page')" class="h-7 w-7 cursor-pointer" fill="currentColor" viewBox="0 0 24 24"><path d="M6.4,2.8c-0.3-0.2-0.6-0.2-0.9,0.1C5.2,3.1,5,3.5,5,3.9v16.2c0,0.4,0.2,0.8,0.5,1c0.3,0.2,0.7,0.2,1-0.1l13.9-8.1 c0.3-0.2,0.5-0.5,0.5-0.9s-0.2-0.7-0.5-0.9L6.4,2.8z"/></svg>
                <img id="profile-icon-footer-reels" onclick="showPage('profile-page')" class="w-7 h-7 rounded-full object-cover cursor-pointer" src="" alt="Profile">
            </footer>
        </div>
        
        <!-- Page 11: Notifications Page -->
        <div id="notifications-page" class="page bg-black text-white">
            <header class="p-4 sticky top-0 bg-black z-10 border-b border-gray-800">
                <h1 class="text-xl font-bold">Notifications</h1>
            </header>
            <main id="notifications-container" class="flex-1 overflow-y-auto p-4">
                <!-- Notifications will be injected here -->
            </main>
             <footer class="p-3 flex items-center justify-around border-t border-gray-800 sticky bottom-0 bg-black z-10">
                <svg onclick="showPage('feed-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                <svg onclick="showPage('search-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                <svg onclick="showPage('new-post-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-3-3v6m6 6H6a3 3 0 01-3-3V6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3z" /></svg>
                <svg onclick="showPage('reels-page')" class="h-7 w-7 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <img id="profile-icon-footer-notifications" onclick="showPage('profile-page')" class="w-7 h-7 rounded-full object-cover cursor-pointer" src="" alt="Profile">
            </footer>
        </div>

        <!-- Page 12: Followers Page -->
        <div id="followers-page" class="page bg-black text-white">
            <header class="p-4 flex items-center space-x-4 sticky top-0 bg-black z-10 border-b border-gray-800">
                <svg onclick="showPage('profile-page')" class="h-6 w-6 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
                <h1 class="text-lg font-bold">Followers</h1>
            </header>
            <main id="followers-list" class="flex-1 overflow-y-auto p-4"></main>
        </div>

        <!-- Page 13: Following Page -->
        <div id="following-page" class="page bg-black text-white">
            <header class="p-4 flex items-center space-x-4 sticky top-0 bg-black z-10 border-b border-gray-800">
                <svg onclick="showPage('profile-page')" class="h-6 w-6 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
                <h1 class="text-lg font-bold">Following</h1>
            </header>
            <main id="following-list" class="flex-1 overflow-y-auto p-4"></main>
        </div>


    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="add-story-input" accept="image/*" class="hidden">
    <input type="file" id="add-post-input" accept="image/*" class="hidden">


    <script>
        // --- GLOBAL STATE ---
        let loggedInUsername = "lucknowi_nawab";
        let userFullName = "Aslam Khan";
        let userBio = "Muskuraiye, aap Lucknow mein hain 😊";
        const defaultProfilePic = "https://i.postimg.cc/Bb34bCcz/Screenshot-2025-10-08-19-32-12-84-99c04817c0de5652397fc8b56c3b3817.jpg";

        // --- DATA ---
        const stories = ["Sonakshi", "Khushi", "Pari", "Priya", "Sunny", "Anjali", "Riya", "Vikas", "Mohit"];
        let posts = [
            { id: 1, user: "Priya", img: "https://picsum.photos/seed/post3/500/700", likes: 2198, caption: "Coffee and code. 💻☕", time: "35 MINUTES AGO" },
            { id: 2, user: "Sunny", img: "https://picsum.photos/seed/post2/500/500", likes: 853, caption: "Exploring the city.", time: "4 HOURS AGO" },
            { id: 3, user: "Vikas", img: "https://picsum.photos/seed/post4/500/800", likes: 5402, caption: "Morning workout vibes.", time: "10 HOURS AGO", video: true },
            { id: 4, user: "Sonakshi", img: "https://picsum.photos/seed/post1/500/600", likes: 1204, caption: "Beautiful sunset! 🌅", time: "YESTERDAY" },
        ];
         const reelsData = [
            { user: "awadh_memes", videoUrl: "https://picsum.photos/seed/reel1/400/800", caption: "Lucknow metro things 😂 #lucknow #memes", likes: "102k", comments: "1,245" },
            { user: "foodie_nawab", videoUrl: "https://picsum.photos/seed/reel2/400/800", caption: "Trying Tunday Kababi for the first time! 🔥", likes: "56.1k", comments: "876" },
            { user: "sadia_writes", videoUrl: "https://picsum.photos/seed/reel3/400/800", caption: "Shaam-e-awadh ki baat hi kuch aur hai...", likes: "201k", comments: "4,532" },
        ];
        let currentReelIndex = 0;
        const notifications = [
            { type: 'follow', user: 'nawab_zaidi', time: '2h', period: 'Today' },
            { type: 'like', user: 'sonakshi', post_id: 4, time: '5h', period: 'Today' },
            { type: 'like', user: 'sunny', post_id: 2, time: '8h', period: 'Today' },
            { type: 'follow', user: 'foodie_nawab', time: '2d', period: 'This Week' },
            { type: 'like', user: 'priya', post_id: 1, time: '3d', period: 'This Week' },
            { type: 'follow', user: 'sadia_writes', time: '1w', period: 'This Month' },
        ];
        const followersList = [ { username: 'sonakshi', fullname: 'Sonakshi Sinha' }, { username: 'nawab_zaidi', fullname: 'Zaid Khan' }, { username: 'foodie_nawab', fullname: 'Ayan' }];
        const followingList = [ { username: 'priya', fullname: 'Priya Sharma' }, { username: 'sunny', fullname: 'Sunny Kumar' } ];
        const messages = [
            { user: "Sonakshiiiiii", lastMsg: "ignore mat kro yar 😟", time: "now", unread: true, story: true }, { user: "Khushi", lastMsg: "App singal ho kya ?", time: "3m", unread: false, story: true }, { user: "Pari sharma", lastMsg: "Heyy 😌", time: "8m", unread: false, story: true }, { user: "Queen piyu", lastMsg: "replay to kardo ji ♡", time: "12m", unread: false, story: true }, { user: "Sonam", lastMsg: "App kha ho abi ?", time: "14m", unread: false, story: true }, { user: "Divya rani", lastMsg: "ignore kar rhe ho mujhe 😒", time: "17m", unread: false, story: true }, { user: "Cutie Riya", lastMsg: "Janu gar ajjao ajj gar pr koi ...", time: "21m", unread: false, story: true }, { user: "Priya", lastMsg: "Hlo baby kese ho ?", time: "35m", unread: false, story: true, verified: true }, { user: "Sunny Kumar", lastMsg: "Love you 😘💕", time: "now", unread: false, story: true }, { user: "🔥jaat 🔥jaatni💫", lastMsg: "Love you 🥰💕", time: "now", unread: false, story: false }, { user: "karishma_singhaniya12", lastMsg: "Love you 🥺", time: "2m", unread: false, story: true }, { user: "anan.di6799", lastMsg: "Love you 💕", time: "2m", unread: false, story: true }, { user: "vaishali paswan", lastMsg: "2 new messages", time: "2h", unread: true, story: false }, { user: "strawberry_girl___", lastMsg: "3 new messages", time: "2d", unread: true, story: true }, { user: "cute_086", lastMsg: "3 new messages", time: "3d", unread: true, story: false }, { user: "iem._yewr..suhu", lastMsg: "You replied to...", time: "3d", unread: false, story: true }, { user: "__s3n00rii7a___", lastMsg: "😟😥😞", time: "4d", unread: false, story: true }, { user: "itxbabbx_", lastMsg: "👩‍❤️‍💋‍👨💔", time: "5d", unread: false, story: true }, { user: "NITIKA", lastMsg: "Hello sir", time: "2m", unread: false, story: true }, { user: "anjali_rozzy21", lastMsg: "Kon ho ap", time: "5m", unread: false, story: true }, { user: "🧿 Anjali", lastMsg: "Ooo hello sir please reply", time: "5m", unread: false, story: true }, { user: "💕 anjali 💕", lastMsg: "This account can't receive ...", time: "6m", unread: false, story: false }, { user: "Rishika Jain", lastMsg: "Replied to your note: ❤...", time: "24m", unread: true, story: true }, { user: "(★★MĖŇŤŁÊ_QÚÊÊŇ★★)", lastMsg: "4 new messages", time: "1h", unread: true, story: false }, { user: "f.l.a.r.t.y_g.i.r.l", lastMsg: "Good morning", time: "4h", unread: false, story: false }, { user: "Y/N~", lastMsg: "4 new messages", time: "5h", unread: true, story: false }, { user: "7991594650thakur soumy", lastMsg: "2 new messages", time: "5h", unread: true, story: false },
        ];


        // --- PAGE SWITCHING & UI UPDATE LOGIC ---
        const pages = document.querySelectorAll('.page');
        
        function showPage(pageId, data = {}) {
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            // Update UI elements with the current user's data
            updateUserUIData();
            
            if (pageId === 'chat-page') {
                const { user, avatar } = data;
                document.getElementById('chat-header').innerHTML = `<div class="flex items-center space-x-3"><svg onclick="showPage('dms-page')" class="h-6 w-6 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg><img class="w-10 h-10 rounded-full object-cover" src="${avatar}" alt="${user}"><div><h2 class="font-semibold">${user}</h2><p class="text-xs text-gray-400">Active now</p></div></div><div class="flex items-center space-x-4"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></div>`;
                document.getElementById('chat-page-avatar-receiver').src = avatar;
                document.getElementById('chat-page-avatar-receiver-2').src = avatar;
                document.getElementById('chat-page-avatar-receiver-3').src = avatar;
            } else if (pageId === 'edit-profile-page') {
                // Populate edit fields with current data
                document.getElementById('edit-profile-picture').src = localStorage.getItem('userProfilePicture') || defaultProfilePic;
                document.getElementById('edit-name-input').value = localStorage.getItem('userFullName') || userFullName;
                document.getElementById('edit-username-input').value = localStorage.getItem('loggedInUsername') || loggedInUsername;
                document.getElementById('edit-bio-input').value = localStorage.getItem('userBio') || userBio;
            } else if (pageId === 'search-page') {
                renderExploreGrid();
            } else if (pageId === 'reels-page') {
                loadReel(currentReelIndex);
            } else if (pageId === 'notifications-page') {
                renderNotifications();
            } else if (pageId === 'followers-page') {
                renderFollowersList();
            } else if (pageId === 'following-page') {
                renderFollowingList();
            }
        }
        
        function switchProfileTab(selectedTab) {
            document.querySelectorAll('.profile-tab').forEach(tab => tab.classList.remove('active'));
            selectedTab.classList.add('active');
        }

        // --- STORY LOGIC ---
        function showStory(user, image) {
            showPage('story-page');
            document.getElementById('story-user-avatar').src = (user === loggedInUsername) ? (localStorage.getItem('userProfilePicture') || defaultProfilePic) : `https://picsum.photos/seed/${user.replace(/\s/g, '')}/32/32`;
            document.getElementById('story-username').textContent = user;
            document.getElementById('story-image').src = image;

            // Reset and start progress bar animation
            const progressBar = document.getElementById('story-progress-bar');
            progressBar.innerHTML = '<div class="progress-bar-inner h-full bg-white rounded-full"></div>';
            
            const storyFooter = document.getElementById('story-footer');
            if (user === loggedInUsername) {
                storyFooter.classList.remove('hidden');
            } else {
                storyFooter.classList.add('hidden');
            }

            setTimeout(() => {
                if (document.getElementById('story-page').classList.contains('active')) {
                   showPage('feed-page');
                }
            }, 5000); // Close story after 5 seconds
        }

        // --- LOGIN & PROFILE DATA HANDLING ---
        function loadUserData() {
            loggedInUsername = localStorage.getItem('loggedInUsername') || loggedInUsername;
            userFullName = localStorage.getItem('userFullName') || userFullName;
            userBio = localStorage.getItem('userBio') || userBio;
        }
        
        function updateUserUIData() {
            loadUserData();
            const profilePicUrl = localStorage.getItem('userProfilePicture') || defaultProfilePic;
            
            // Update all profile pictures
            document.getElementById('profile-picture-main').src = profilePicUrl;
            document.getElementById('profile-icon-footer').src = profilePicUrl;
             document.getElementById('profile-icon-footer-search').src = profilePicUrl;
             document.getElementById('profile-icon-footer-reels').src = profilePicUrl;
             document.getElementById('profile-icon-footer-notifications').src = profilePicUrl;
            document.getElementById('edit-profile-picture').src = profilePicUrl;
            
            const userStoryPic = document.getElementById('user-story-picture');
            if(userStoryPic) userStoryPic.src = profilePicUrl;

            // Update text elements
            document.getElementById('dm-username').textContent = loggedInUsername;
            document.getElementById('profile-username-header').textContent = loggedInUsername;
            document.getElementById('profile-fullname').textContent = userFullName; 
            document.getElementById('profile-bio-text').textContent = userBio;

            const userStoryUsername = document.getElementById('user-story-username');
            if(userStoryUsername) userStoryUsername.textContent = "Aapki Story";
        }
        
        document.getElementById('done-editing-button').addEventListener('click', () => {
            localStorage.setItem('userFullName', document.getElementById('edit-name-input').value);
            localStorage.setItem('loggedInUsername', document.getElementById('edit-username-input').value);
            localStorage.setItem('userBio', document.getElementById('edit-bio-input').value);
            showPage('profile-page');
        });

        document.getElementById('profile-pic-input-edit').addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    localStorage.setItem('userProfilePicture', e.target.result);
                    updateUserUIData();
                }
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('add-story-input').addEventListener('change', (event) => {
             const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    localStorage.setItem('userStoryImage', e.target.result);
                    renderDynamicContent(); // Re-render stories section to show the ring
                    showStory(loggedInUsername, e.target.result);
                }
                reader.readAsDataURL(file);
            }
        });
        
        // --- NEW POST LOGIC ---
        document.getElementById('select-photo-button').addEventListener('click', () => {
            document.getElementById('add-post-input').click();
        });

        document.getElementById('add-post-input').addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    const postPreviewContainer = document.getElementById('post-preview-container');
                    const postImagePreview = document.getElementById('post-image-preview');

                    postImagePreview.src = imageUrl;
                    postImagePreview.classList.remove('hidden');
                    postPreviewContainer.querySelector('p').classList.add('hidden');
                    postPreviewContainer.querySelector('button').classList.add('hidden');
                }
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('share-post-button').addEventListener('click', () => {
            const caption = document.getElementById('caption-input').value;
            const imageUrl = document.getElementById('post-image-preview').src;

            if (!imageUrl || imageUrl.endsWith('#')) {
                // Simple validation: No image selected
                return;
            }

            const newPost = {
                id: posts.length + 1, // simple id generation
                user: loggedInUsername,
                img: imageUrl,
                likes: 0,
                caption: caption,
                time: "JUST NOW"
            };

            posts.unshift(newPost); // Add to the beginning of the posts array

            // Reset the new post page for next time
            document.getElementById('caption-input').value = '';
            document.getElementById('post-image-preview').src = '#';
            document.getElementById('post-image-preview').classList.add('hidden');
            document.getElementById('post-preview-container').querySelector('p').classList.remove('hidden');
            document.getElementById('post-preview-container').querySelector('button').classList.remove('hidden');

            showPage('feed-page');
            renderDynamicContent(); // Re-render the feed to show the new post
        });
        
         // --- REELS LOGIC ---
        function loadReel(index) {
            const reel = reelsData[index];
            const reelsContainer = document.getElementById('reels-container');
            // NOTE: We are using an image as a placeholder for a video.
            reelsContainer.innerHTML = `
                <img src="${reel.videoUrl}" class="absolute inset-0 w-full h-full object-cover z-0" alt="Reel by ${reel.user}">
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent z-10"></div>
                <div class="absolute bottom-16 left-4 right-20 text-white z-20">
                    <div class="flex items-center space-x-2">
                        <img src="https://picsum.photos/seed/${reel.user}/40/40" class="w-8 h-8 rounded-full border-2 border-white object-cover">
                        <p class="font-bold text-sm">${reel.user}</p>
                        <button class="border border-white rounded px-2 py-0.5 text-xs font-semibold">Follow</button>
                    </div>
                    <p class="text-sm mt-2">${reel.caption}</p>
                </div>
                <div class="absolute bottom-16 right-2 flex flex-col items-center space-y-5 text-white z-20">
                    <div class="text-center">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" /></svg>
                        <p class="text-xs font-semibold">${reel.likes}</p>
                    </div>
                    <div class="text-center">
                         <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                        <p class="text-xs font-semibold">${reel.comments}</p>
                    </div>
                     <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" /></svg>
                </div>
            `;
        }
        
        let touchStartY = 0;
        document.getElementById('reels-container').addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        });

        document.getElementById('reels-container').addEventListener('touchend', (e) => {
            const touchEndY = e.changedTouches[0].clientY;
            if (touchStartY - touchEndY > 50) { // Swiped up
                currentReelIndex = (currentReelIndex + 1) % reelsData.length;
                loadReel(currentReelIndex);
            } else if (touchEndY - touchStartY > 50) { // Swiped down
                currentReelIndex = (currentReelIndex - 1 + reelsData.length) % reelsData.length;
                loadReel(currentReelIndex);
            }
        });


        // --- DYNAMIC CONTENT GENERATION ---
        function renderFollowersList() {
            const list = document.getElementById('followers-list');
            list.innerHTML = '';
            followersList.forEach(user => {
                list.innerHTML += `<div class="flex items-center space-x-3 py-2">
                    <img src="https://picsum.photos/seed/${user.username}/48/48" class="w-12 h-12 rounded-full object-cover">
                    <div class="flex-1">
                        <p class="font-bold">${user.username}</p>
                        <p class="text-sm text-gray-400">${user.fullname}</p>
                    </div>
                    <button class="bg-gray-800 text-white text-sm font-semibold px-4 py-1 rounded-md">Remove</button>
                </div>`;
            });
        }
        function renderFollowingList() {
            const list = document.getElementById('following-list');
            list.innerHTML = '';
            followingList.forEach(user => {
                list.innerHTML += `<div class="flex items-center space-x-3 py-2">
                    <img src="https://picsum.photos/seed/${user.username}/48/48" class="w-12 h-12 rounded-full object-cover">
                    <div class="flex-1">
                        <p class="font-bold">${user.username}</p>
                        <p class="text-sm text-gray-400">${user.fullname}</p>
                    </div>
                    <button class="bg-gray-800 text-white text-sm font-semibold px-4 py-1 rounded-md">Following</button>
                </div>`;
            });
        }


        function renderNotifications() {
            const container = document.getElementById('notifications-container');
            container.innerHTML = '';
            let currentPeriod = '';

            notifications.forEach(noti => {
                if (noti.period !== currentPeriod) {
                    currentPeriod = noti.period;
                    container.innerHTML += `<h2 class="font-bold text-lg my-2">${currentPeriod}</h2>`;
                }
                
                let notiHTML = `<div class="flex items-center space-x-3 py-2">
                                    <img src="https://picsum.photos/seed/${noti.user}/48/48" class="w-12 h-12 rounded-full object-cover">
                                    <p class="flex-1 text-sm">
                                        <span class="font-bold">${noti.user}</span>`;
                
                if (noti.type === 'follow') {
                    notiHTML += ` started following you. <span class="text-gray-400">${noti.time}</span>
                                    </p>
                                    <button class="bg-blue-500 text-white text-sm font-semibold px-4 py-1 rounded-md">Follow back</button>
                                </div>`;
                } else if (noti.type === 'like') {
                    const post = posts.find(p => p.id === noti.post_id);
                    notiHTML += ` liked your post. <span class="text-gray-400">${noti.time}</span>
                                    </p>
                                    <img src="${post.img}" class="w-12 h-12 object-cover rounded-md">
                                </div>`;
                }
                container.innerHTML += notiHTML;
            });
        }


        function renderExploreGrid() {
            const exploreGrid = document.getElementById('explore-grid');
            if (exploreGrid.children.length === 0) { // Only render if it's empty
                for (let i = 1; i <= 21; i++) {
                    exploreGrid.innerHTML += `<img src="https://picsum.photos/seed/explore${i}/300/300" alt="explore content" class="w-full h-full object-cover aspect-square">`;
                }
            }
        }

        function renderDynamicContent() {
            // Render Stories
            const storiesContainer = document.getElementById('stories-container');
            if (storiesContainer) {
                storiesContainer.innerHTML = '';
                const userStoryImage = localStorage.getItem('userStoryImage');
                const hasStoryClass = userStoryImage ? 'p-0.5 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500' : 'border-2 border-gray-800';
                const addStoryIcon = !userStoryImage ? `<div class="absolute bottom-0 right-0 bg-blue-500 rounded-full w-5 h-5 flex items-center justify-center border-2 border-black"><svg class="h-3 w-3 text-white" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg></div>` : '';
                storiesContainer.innerHTML += `
                    <div class="flex-shrink-0 text-center cursor-pointer" id="your-story-container">
                        <div class="relative">
                            <div class="w-16 h-16 rounded-full ${hasStoryClass}">
                                <img id="user-story-picture" class="w-full h-full rounded-full bg-black border-2 border-black object-cover" src="" alt="Your Story">
                            </div>
                            ${addStoryIcon}
                        </div>
                        <p id="user-story-username" class="text-xs mt-1 text-gray-400 truncate w-16"></p>
                    </div>`;
                document.getElementById('your-story-container').addEventListener('click', () => {
                    if (userStoryImage) showStory(loggedInUsername, userStoryImage);
                    else document.getElementById('add-story-input').click();
                });
                updateUserUIData();
                stories.forEach(name => {
                    const storyImg = `https://picsum.photos/seed/${name.replace(/\s/g, '')}/500/800`;
                    storiesContainer.innerHTML += `<div class="flex-shrink-0 text-center cursor-pointer" onclick="showStory('${name}', '${storyImg}')"><div class="w-16 h-16 rounded-full p-0.5 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500"><img class="w-full h-full rounded-full bg-black border-2 border-black object-cover" src="https://picsum.photos/seed/${name.replace(/\s/g, '')}/64/64" alt="${name}'s Story"></div><p class="text-xs mt-1 truncate w-16">${name}</p></div>`;
                });
            }
            
            // Render Posts
            const postsContainer = document.getElementById('posts-container');
            if (postsContainer) {
                postsContainer.innerHTML = ''; 
                posts.forEach(post => { 
                    const videoIcon = post.video ? `<svg class="absolute top-4 right-4 h-6 w-6 text-white drop-shadow-lg" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>` : '';
                    const postUserAvatar = (post.user === loggedInUsername) ? (localStorage.getItem('userProfilePicture') || defaultProfilePic) : `https://picsum.photos/seed/${post.user}/32/32`;
                    postsContainer.innerHTML += `<article class="border-b border-gray-800"><div class="flex items-center p-3"><div class="w-8 h-8 rounded-full p-0.5 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500"><img class="w-full h-full rounded-full bg-black border border-black object-cover" src="${postUserAvatar}" alt="${post.user}"></div><p class="font-semibold text-sm ml-3 flex-grow">${post.user}</p><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path></svg></div><div class="relative"><img class="w-full h-auto object-cover" src="${post.img}" alt="Post by ${post.user}">${videoIcon}</div><div class="p-3"><div class="flex items-center justify-between"><div class="flex items-center space-x-4"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 016.364 0L12 7.636l1.318-1.318a4.5 4.5 0 116.364 6.364L12 20.364l-7.682-7.682a4.5 4.5 0 010-6.364z"></path></svg><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></div><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg></div><p class="font-semibold text-sm mt-2">${post.likes.toLocaleString()} likes</p><p class="text-sm mt-1"><span class="font-semibold">${post.user}</span> ${post.caption}</p><p class="text-xs text-gray-500 mt-1">${post.time}</p></div></article>`;
                });
            }
             const messagesContainer = document.getElementById('messages-container');
            const notesContainer = document.getElementById('notes-container');
            if (notesContainer) {
                notesContainer.innerHTML = `<div class="flex-shrink-0 text-center"><div class="relative w-16 h-16"><img class="w-full h-full rounded-full object-cover" src="https://i.postimg.cc/kX8X5G5j/skull-note.jpg" alt="Your Note"><div class="absolute inset-0 bg-black bg-opacity-30 rounded-full"></div><p class="absolute inset-0 flex items-center justify-center text-white text-xs font-semibold text-center leading-tight">Share a note</p></div><p class="text-xs mt-1 text-gray-400">Your note</p></div><div class="flex-shrink-0 text-center"><div class="relative w-16 h-16"><img class="w-full h-full rounded-full object-cover" src="https://i.postimg.cc/L8y2zTfY/map-note.jpg" alt="Map"><span class="absolute top-0 right-0 bg-blue-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full">New</span></div><p class="text-xs mt-1">Map</p></div>`;
            }
            if (messagesContainer) {
                messagesContainer.innerHTML = '';
                messages.forEach(msg => { const avatarUrl = `https://picsum.photos/seed/${msg.user.replace(/[^a-zA-Z0-9]/g, '')}/64/64`; const storyClass = msg.story ? 'p-0.5 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500' : ''; const unreadDot = msg.unread ? '<div class="w-2 h-2 bg-blue-500 rounded-full ml-auto"></div>' : '<svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg>'; const textClass = msg.unread ? 'text-white font-semibold' : 'text-gray-400'; const verifiedBadge = msg.verified ? `<svg class="w-4 h-4 text-blue-500 ml-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1.25 17.292l-4.5-4.364 1.857-1.858 2.643 2.506 5.643-5.784 1.857 1.857-7.5 7.643z"/></svg>`: ''; messagesContainer.innerHTML += `<div class="flex items-center py-2 space-x-4 cursor-pointer" onclick="showPage('chat-page', { user: '${msg.user.replace(/'/g, "\\'")}', avatar: '${avatarUrl}' })"><div class="w-14 h-14 rounded-full flex-shrink-0 ${storyClass}"><img class="w-full h-full rounded-full bg-black border-2 border-black object-cover" src="${avatarUrl}" alt="${msg.user}"></div><div class="flex-1 overflow-hidden"><p class="${textClass} flex items-center"><span class="truncate">${msg.user}</span> ${verifiedBadge}</p><p class="text-sm ${textClass} truncate">${msg.lastMsg} · ${msg.time}</p></div>${unreadDot}</div>`;});
            }
        }
        
        function initializeApp() {
            // Load user data from local storage first
            loadUserData();
            // Directly show the feed page on load
            showPage('feed-page');
            renderDynamicContent();
            // --- PULL-TO-REFRESH PREVENTION ---
            const feedMainContent = document.getElementById('feed-main-content');
            if (feedMainContent) {
                let firstTouchY = 0;
                feedMainContent.addEventListener('touchstart', (e) => { firstTouchY = e.touches[0].clientY; });
                feedMainContent.addEventListener('touchmove', (e) => {
                    const touchY = e.touches[0].clientY;
                    const scrollTop = feedMainContent.scrollTop;
                    if (scrollTop === 0 && touchY > firstTouchY) {
                        e.preventDefault();
                    }
                });
            }
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>